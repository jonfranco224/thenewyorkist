---
import CardRowTall from "../components/CardRowTall.astro";
import Layout from "../components/Layout.astro";
import { getCollection } from "astro:content";

const allPosts = await getCollection("articles");

// Sort posts by date in descending order (newest first)
allPosts.sort((a, b) => {
  const dateA = new Date(a.data.date).getTime(); // Convert to timestamp
  const dateB = new Date(b.data.date).getTime(); // Convert to timestamp
  return dateA - dateB;
});

// Access specific posts
const firstPost = allPosts[0];
const culturePost = allPosts[4];
---

<Layout
	seo={{ 
		title: 'The New Yorkist',
		description: 'Your Most Trusted News Source Since 1624 â€“ Delivering reliable, timely, and accurate news for over 50 years. Stay informed with updates you can count on!',
		type: 'website',
		image: { src: '/logo.png' }
	}}
>
	<div class="mx-auto">
		<section class="border-b py-5 flex flex-col lg:flex-row">
			<a
				href={`/articles/${firstPost?.slug}`}
				class="flex w-full lg:w-[81%] lg:pr-6"
			>
				<article class="flex flex-col md:flex-row gap-5">
					<img
						class="flex-1 md:aspect-[7/5] object-cover overflow-hidden"
						src={firstPost?.data.image.src}
						alt={firstPost?.data.image.alt}
					/>
					<div class="md:flex-1 lg:py-[1px]">
						<div class="w-full max-w-full lg:max-w-[500px]">
							<small class="block w-max text-extra-small uppercase bold italic">{firstPost?.data?.category}</small>
							<p class="title h3 pt-3 pb-2 font-bold">
								{firstPost?.data.title}
							</p>
							<p class="small pb-2 text-[var(--dark-gray)]">{firstPost?.data.description}</p>
							<div class="flex items-start pt-2 text-extra-small italic">
								By {firstPost?.data?.author}
							 </div>
						</div>
					</div>
				</article>
			</a>
			<div class="border-l-0 lg:border-l px-0 lg:pl-6 w-full lg:w-[25%] mt-5 lg:mt-0 lg:my-0">
				<!-- <p class="small font-bold pb-2">Spotlight</p> -->
				<div class="flex flex-col md:flex-row lg:flex-col gap-0 md:gap-4 lg:gap-0">
					<div class="flex-1 flex flex-col border-0 md:border-r lg:border-0 pr-5 lg:pr-0">
						<a href={`/articles/${allPosts[1].slug}`} class="h-[50%] border-b py-3 lg:pt-0">
							<small class="pb-1 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[1]?.data?.category}</small>
							<p class="title text-[14px] lg:text-[13px] !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[1]?.data?.title}
							</p>
						</a>
						<a href={`/articles/${allPosts[2].slug}`} class="h-[50%] border-b md:border-0 lg:border-b py-3">
							<small class="pb-1 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[2]?.data?.category}</small>
							<p class="title text-[14px] lg:text-[13px] !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[2]?.data?.title}
							</p>
						</a>
					</div>
					<div class="flex-1 flex flex-col">
						<a href={`/articles/${allPosts[3].slug}`} class="h-[50%] py-3 border-b">
							<small class="pb-1 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[3]?.data?.category}</small>
							<p class="title text-[14px] lg:text-[13px] !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[3]?.data?.title}
							</p>
						</a>
						<a href={`/articles/${allPosts[4].slug}`} class="h-[50%] py-3 lg:pb-0">
							<small class="pb-1 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[4]?.data?.category}</small>
							<p class="title text-[14px] lg:text-[13px] !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[4]?.data?.title}
							</p>
						</a>
					</div>	
				</div>
			</div>
		</section>
		
		<CardRowTall borderB posts={allPosts} />
		
		<div class="py-5 md:py-5 border-b">
			<section class="bg-[rgb(11,12,18)]">
				<a
					href={`/articles/${culturePost?.slug}`}
					class="bg-white shadow-md rounded-lg overflow-hidden"
				>
					<article class="flex flex-col-reverse md:flex-row">
						<div class="md:w-[50%] flex items-center p-[30px] md:p-[50px] lg:p-[40px]">
							<div class="max-w-[450px] m-auto">
								<p class="title h2 !leading-[1.3] text-white text-center">
									{culturePost?.data.title}
								</p>
								<p class="text-sm py-4 text-white text-center">{culturePost?.data?.description}</p>
								<div class="flex items-start text-white italic">
									<small class="opacity-[.7] text-center w-full">By {culturePost?.data?.author}</small>
							 </div>
							</div>
						</div>
						<div class="flex md:w-[50%]">
							<img
								class="h-full md:aspect-[7/5] object-cover overflow-hidden"
								src={culturePost?.data?.image.src}
								alt={culturePost?.data?.image.alt}
							/>
						</div>
					</article>
				</a>
			</section>
		</div>
		
		<p class="!leading-[1] mt-5">The Intern Desk</p>
		<section class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-3 pt-5  lg:[&>*]:px-4 [&>:first-child]:pl-0 [&>:last-child]:pr-0 [&>:last-child]:border-0 gap-5 lg:gap-0">
			{
				[allPosts[0], allPosts[1], allPosts[2]].map((post) => (
					<a
						href={`/articles/${post.slug}`}
						class="flex flex-col lg:border-r"
					>
						<div class="flex flex-col flex-1">
							<div class="flex items-start text-extra-small italic">
								{post.data.category} <span class="inline-block text-[rgb(68,68,68)] px-2">|</span> By {post.data.author} 
							</div>
							<p class="title text-[18px] font-bold !leading-[1.3] pt-3.5 pb-3">
                {post.data.title}
              </p>
						</div>
					</a>
				))
			}
		</section>

		<section class="grid grid-cols-1 sm:grid-cols-3 lg:grid-cols-3 py-5 md:pb-5 border-b lg:[&>*]:px-4 [&>:first-child]:pl-0 [&>:last-child]:pr-0 [&>:last-child]:border-0 gap-5 lg:gap-0">
			{
				[allPosts[0], allPosts[1], allPosts[2]].map((post) => (
					<a
						href={`/articles/${post.slug}`}
						class="flex flex-col lg:border-r"
					>
						<div class="flex flex-col flex-1">
							<div class="flex items-start text-extra-small italic">
								{post.data.category} <span class="inline-block text-[rgb(68,68,68)] px-2">|</span> By {post.data.author} 
							</div>
							<p class="title text-[18px] font-bold !leading-[1.3] pt-3.5 pb-3">
                {post.data.title}
              </p>
						</div>
					</a>
				))
			}
		</section>
		
		<CardRowTall borderB title="In The Know" posts={allPosts} />

		<p class="!leading-[1] mt-5">The Metro Beat</p>
		<section class="border-b py-5 md:py-5 mb-5 flex flex-col lg:flex-row">
			<a
				href={`/articles/${firstPost?.slug}`}
				class="flex w-full lg:w-[50%] lg:pr-6"
			>
				<article class="flex flex-col gap-5">
					<img
						class="flex-1 md:aspect-video object-cover overflow-hidden"
						src={firstPost?.data.image.src}
						alt={firstPost?.data.image.alt}
					/>
					<div class="lg:py-[1px]">
						<div class="w-full max-w-full lg:max-w-[500px]">
							<p class="title h3 pb-2 font-bold">
								{firstPost?.data.title}
							</p>
							<div class="flex items-start pt-2 text-extra-small italic">
								By {firstPost?.data?.author}
							 </div>
						</div>
					</div>
				</article>
			</a>
			<div class="border-l-0 lg:border-l px-0 lg:pl-6 w-full lg:w-[50%] mt-5 lg:mt-0 lg:my-0">
				<!-- <p class="small font-bold pb-2">Spotlight</p> -->
				<div class="flex flex-col md:flex-row lg:flex-col gap-0 md:gap-4 lg:gap-0">
					<div class="flex-1 flex flex-col border-0 md:border-r lg:border-0 pr-5 lg:pr-0">
						<a href="/" class="h-[50%] border-b py-3 lg:pt-0">
							<small class="pb-2 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[1]?.data?.category}</small>
							<p class="title !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[1]?.data?.title}
							</p>
							<small class="pt-2 block w-max text-[12px] lg:text-[10px] capitalize bold italic">By {allPosts[1]?.data?.author}</small>
						</a>
						<a href="/" class="h-[50%] border-b md:border-0 lg:border-b py-3">
							<small class="pb-2 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[2]?.data?.category}</small>
							<p class="title !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[2]?.data?.title}
							</p>
							<small class="pt-2 block w-max text-[12px] lg:text-[10px] capitalize bold italic">By {allPosts[2]?.data?.author}</small>
						</a>
					</div>
					<div class="flex-1 flex flex-col">
						<a href="/" class="h-[50%] py-3 border-b">
							<small class="pb-2 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[3]?.data?.category}</small>
							<p class="title !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[3]?.data?.title}
							</p>
							<small class="pt-2 block w-max text-[12px] lg:text-[10px] capitalize bold italic">By {allPosts[3]?.data?.author}</small>
						</a>
						<a href="/" class="h-[50%] py-3 lg:pb-0">
							<small class="pb-2 block w-max text-[12px] lg:text-[10px] uppercase bold italic">{allPosts[4]?.data?.category}</small>
							<p class="title !leading-[1.4] lg:!leading-[1.25] font-bold">
								{allPosts[4]?.data?.title}
							</p>
							<small class="pt-2 block w-max text-[12px] lg:text-[10px] capitalize bold italic">By {allPosts[4]?.data?.author}</small>
						</a>
					</div>
				</div>
			</div>
		</section>

		<section class="bg-[var(--black)] py-16 px-4 text-center mb-5">
			<p class="h4 !leading-[1.65] text-white m-auto">Readers like you support journalists like us. <br/> Please donate today.</p>
			<a href="/donate" class="hover:text-white border border-white bg-white hover:bg-transparent inline-block p block mt-3  !leading-[1.2] px-6 py-2 rounded-l-full rounded-r-full">
				Donate
			</a>
		</section>
	</div>
</Layout>

